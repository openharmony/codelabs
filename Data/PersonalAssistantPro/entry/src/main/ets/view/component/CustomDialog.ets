/*
 * Copyright (c) 2025 Huawei Device Co., Ltd.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
// src/main/ets/view/component/CustomDialog.ets
import { StyleConstants } from '../../common/constants/StyleConstants';

/**
 * é€šç”¨è‡ªå®šä¹‰å¼¹çª—å†…å®¹ç»„ä»¶
 * * ç”¨äºŽé…åˆ CustomDialogController ä½¿ç”¨
 * æä¾›äº†ç»Ÿä¸€çš„ App é£Žæ ¼å¼¹çª—æ ·å¼ï¼š
 * - æ ‡é¢˜æ 
 * - å†…å®¹åŒºåŸŸ
 * - åº•éƒ¨æŒ‰é’®æ  (å–æ¶ˆ/ç¡®è®¤)
 */
@CustomDialog
export struct CommonDialog {
  // === æŽ§åˆ¶å™¨ (å¿…é¡») ===
  controller: CustomDialogController;
  // === å±žæ€§ ===
  /** å¼¹çª—æ ‡é¢˜ */
  // ðŸ“ [ä¿®æ”¹] ä½¿ç”¨ app.string.common_tip æ›¿ä»£ 'æç¤º'
  title: string | Resource = $r('app.string.common_tip');
  /** å¼¹çª—å†…å®¹ */
  message: string | Resource = '';
  /** å–æ¶ˆæŒ‰é’®æ–‡æœ¬ */
  // ðŸ“ [ä¿®æ”¹] ä½¿ç”¨ app.string.common_cancel æ›¿ä»£ 'å–æ¶ˆ'
  cancelText: string | Resource = $r('app.string.common_cancel');
  /** ç¡®è®¤æŒ‰é’®æ–‡æœ¬ */
  // ðŸ“ [ä¿®æ”¹] ä½¿ç”¨ app.string.common_confirm æ›¿ä»£ 'ç¡®å®š'
  confirmText: string | Resource = $r('app.string.common_confirm');
  // === å›žè°ƒå‡½æ•° ===
  /** ç‚¹å‡»å–æ¶ˆçš„å›žè°ƒ */
  onCancel?: () => void;
  /** ç‚¹å‡»ç¡®è®¤çš„å›žè°ƒ */
  onConfirm?: () => void;

  build() {
    Column() {
      // 1. æ ‡é¢˜åŒºåŸŸ
      Text(this.title)
        .fontSize(StyleConstants.ICON_SIZE_LG)
        .fontWeight(FontWeight.Bold)
        .fontColor(StyleConstants.COLOR_TEXT_PRIMARY)
        .margin({ top: StyleConstants.SPACE_XL, bottom: StyleConstants.SPACE_MD })
        .textAlign(TextAlign.Center)
        .width('100%')

      // 2. å†…å®¹åŒºåŸŸ
      Text(this.message)
        .fontSize(StyleConstants.ICON_SIZE_MD)
        .fontColor(StyleConstants.COLOR_TEXT_SECONDARY)
        .margin({
          bottom: StyleConstants.SPACE_XL,
          left: StyleConstants.SPACE_LG,
          right: StyleConstants.SPACE_LG
        })
        .textAlign(TextAlign.Center)
        .lineHeight(22) // å¢žåŠ è¡Œé«˜ï¼Œæå‡å¯è¯»æ€§

      // 3. åˆ†å‰²çº¿
      Divider()
        .color(StyleConstants.COLOR_DIVIDER)
        .width('100%')
        .strokeWidth(1)

      // 4. åº•éƒ¨æŒ‰é’®åŒºåŸŸ
      Row() {
        // --- å–æ¶ˆæŒ‰é’® ---
        Button() {
          Text(this.cancelText)
            .fontSize(StyleConstants.ICON_SIZE_LG)
            .fontColor(StyleConstants.COLOR_TEXT_SECONDARY)
        }
        .type(ButtonType.Normal)
        .backgroundColor(Color.Transparent)
        .layoutWeight(1)
        .height(50)
        .onClick(() => {
          if (this.controller) {
            this.controller.close();
          }
          if (this.onCancel) {
            this.onCancel();
          }
        })

        // æŒ‰é’®ä¸­é—´çš„ç«–çº¿
        Divider()
          .vertical(true)
          .height(30)
          .color(StyleConstants.COLOR_DIVIDER)

        // --- ç¡®è®¤æŒ‰é’® ---
        Button() {
          Text(this.confirmText)
            .fontSize(StyleConstants.ICON_SIZE_LG)
            .fontWeight(FontWeight.Medium)
            .fontColor(StyleConstants.COLOR_PRIMARY)
        }
        .type(ButtonType.Normal)
        .backgroundColor(Color.Transparent)
        .layoutWeight(1)
        .height(50)
        .onClick(() => {
          if (this.controller) {
            this.controller.close();
          }
          if (this.onConfirm) {
            this.onConfirm();
          }
        })
      }
      .width('100%')
      .height(50)
    }
    .width('80%') // å¼¹çª—å®½åº¦
    .backgroundColor(Color.White)
    .borderRadius(StyleConstants.RADIUS_LG)
    // æ·»åŠ ä¸€ç‚¹é˜´å½±æ•ˆæžœ
    .shadow({
      radius: 10,
      color: '#40000000',
      offsetY: 4
    })
  }
}