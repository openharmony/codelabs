/*
 * Copyright (c) 2026 Huawei Device Co., Ltd.
 * Licensed under the Apache License,Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/**
 * LifeHub ä¸»é¡µé¢
 * åŒ…å«åº•éƒ¨å¯¼èˆªæ å’Œå†…å®¹åŒºåŸŸ
 */
import { Dashboard } from './Dashboard';
import { HealthMain } from './health/HealthMain';
import { TravelMain } from './travel/TravelMain';
import { GoalsMain } from './goals/GoalsMain';
import { MoodMain } from './mood/MoodMain';
import { LearningMain } from './learning/LearningMain';
import { DiaryMain } from './diary/DiaryMain';
import { router } from '@kit.ArkUI';

interface IndexRouteParams {
  tab?: number
}

@Entry
@Component
struct Index {
  @State currentTab: number = 0; // å½“å‰é€‰ä¸­çš„æ ‡ç­¾é¡µ

  aboutToAppear() {
    let params: IndexRouteParams | null = null

    try {
      params = router.getParams() as IndexRouteParams
    } catch (e) {
      // å†·å¯åŠ¨ / éžè·¯ç”±è¿›å…¥ï¼Œä¼šèµ°åˆ°è¿™é‡Œï¼Œç›´æŽ¥å¿½ç•¥
      return
    }

    if (params && typeof params.tab === 'number') {
      this.currentTab = params.tab
    }
  }

  build() {
    Column() {
      // å†…å®¹åŒºåŸŸï¼Œå æ»¡å‰©ä½™ç©ºé—´
      Column() {
        if (this.currentTab === 0) {
          Dashboard()
        } else if (this.currentTab === 1) {
          HealthMain()
        } else if (this.currentTab === 2) {
          TravelMain()
        } else if (this.currentTab === 3) {
          GoalsMain()
        } else if (this.currentTab === 4) {
          MoodMain()
        } else if (this.currentTab === 5) {
          LearningMain()
        } else if (this.currentTab === 6) {
          DiaryMain()
        }
      }
      .layoutWeight(1)

      // åº•éƒ¨å¯¼èˆªæ 
      this.buildBottomNav()
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#f5f5f5')
  }

  @Builder
  buildBottomNav() {
    Row() {
      // ä»ªè¡¨ç›˜
      Column() {
        Text('ðŸ ')
          .fontSize(24)
          .opacity(this.currentTab === 0 ? 1 : 0.5)
        Text('é¦–é¡µ')
          .fontSize(12)
          .fontColor(this.currentTab === 0 ? '#007DFF' : '#999')
          .margin({ top: 4 })
      }
      .layoutWeight(1)
      .onClick(() => {
        this.currentTab = 0;
      })

      // å¥åº·
      Column() {
        Text('ðŸ’š')
          .fontSize(24)
          .opacity(this.currentTab === 1 ? 1 : 0.5)
        Text('å¥åº·')
          .fontSize(12)
          .fontColor(this.currentTab === 1 ? '#007DFF' : '#999')
          .margin({ top: 4 })
      }
      .layoutWeight(1)
      .onClick(() => {
        this.currentTab = 1;
      })

      // æ—…è¡Œ
      Column() {
        Text('âœˆï¸')
          .fontSize(24)
          .opacity(this.currentTab === 2 ? 1 : 0.5)
        Text('æ—…è¡Œ')
          .fontSize(12)
          .fontColor(this.currentTab === 2 ? '#007DFF' : '#999')
          .margin({ top: 4 })
      }
      .layoutWeight(1)
      .onClick(() => {
        this.currentTab = 2;
      })

      // ç›®æ ‡
      Column() {
        Text('ðŸŽ¯')
          .fontSize(24)
          .opacity(this.currentTab === 3 ? 1 : 0.5)
        Text('ç›®æ ‡')
          .fontSize(12)
          .fontColor(this.currentTab === 3 ? '#007DFF' : '#999')
          .margin({ top: 4 })
      }
      .layoutWeight(1)
      .onClick(() => {
        this.currentTab = 3;
      })

      // å¿ƒæƒ…
      Column() {
        Text('ðŸ˜Š')
          .fontSize(24)
          .opacity(this.currentTab === 4 ? 1 : 0.5)
        Text('å¿ƒæƒ…')
          .fontSize(12)
          .fontColor(this.currentTab === 4 ? '#007DFF' : '#999')
          .margin({ top: 4 })
      }
      .layoutWeight(1)
      .onClick(() => {
        this.currentTab = 4;
      })

      // å­¦ä¹ 
      Column() {
        Text('ðŸ“š')
          .fontSize(24)
          .opacity(this.currentTab === 5 ? 1 : 0.5)
        Text('å­¦ä¹ ')
          .fontSize(12)
          .fontColor(this.currentTab === 5 ? '#007DFF' : '#999')
          .margin({ top: 4 })
      }
      .layoutWeight(1)
      .onClick(() => {
        this.currentTab = 5;
      })

      // æ—¥è®°
      Column() {
        Text('ðŸ“')
          .fontSize(24)
          .opacity(this.currentTab === 6 ? 1 : 0.5)
        Text('æ—¥è®°')
          .fontSize(12)
          .fontColor(this.currentTab === 6 ? '#007DFF' : '#999')
          .margin({ top: 4 })
      }
      .layoutWeight(1)
      .onClick(() => {
        this.currentTab = 6;
      })
    }
    .width('100%')
    .height(60)
    .padding({ top: 8, bottom: 8 })
    .margin({ bottom: 16 })
    .backgroundColor(Color.White)
    .shadow({
      radius: 8,
      color: '#10000000',
      offsetX: 0,
      offsetY: -2
    })
  }
}
